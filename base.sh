#!/bin/bash
. /root/work/malware/checker.sh

rm -rf /root/work/malware/hashes
mkdir /root/work/malware/hashes

checkPath > /root/work/malware/hashes/path.txt

if [[ $# -ne 1 ]]
  then
    echo "No Special File Argument Provided"
  else
    shopt -s -o nounset
    line=0
    while read filePath
      do
        let ++line
          if [ -z $filePath ]
            then
              continue
          fi

          if [ ${filePath:0:1} = "#" ]
            then
              continue
          fi

          checkFile $filePath >> /root/work/malware/hashes/critical.txt

      done < $1
fi

checkSharedObjects > /root/work/malware/hashes/sharedobjects.txt

checkSUIDFiles > /root/work/malware/hashes/suidfiles.txt

